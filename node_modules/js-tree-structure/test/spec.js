import {Tree, ArrayTree} from '../src/index.js'

let demoTree = [
  {
    node_id: "182",
    parent_id: "0",
    application_id: "1",
    application_node_id: "182",
    path: "0",
    name: "首页",
    url: "/home/index",
    is_del: "0",
    is_show_menu: "1",
    sort: "-999",
    icon: "home.png",
    sub_folder: "",
    remark: "",
    danger: "2",
    menu: "1",
    id: "182",
    pid: "0",
    appid: "1"
  },
  {
    node_id: "2894",
    parent_id: "0",
    application_id: "1",
    application_node_id: "2894",
    path: "0",
    name: "新版权限管理",
    url: "",
    is_del: "0",
    is_show_menu: "1",
    sort: "-10",
    icon: "default.png",
    sub_folder: "",
    remark: "",
    danger: "2",
    menu: "1",
    id: "2894",
    pid: "0",
    appid: "1",
    _child: [
      {
        node_id: "2895",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "2895",
        path: "0-2894",
        name: "组织架构管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "2895",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "2896",
            parent_id: "2895",
            application_id: "1",
            application_node_id: "2896",
            path: "0-2894-2895",
            name: "组织架构列表",
            url: "/Newsystem/Organization/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "2896",
            pid: "2895",
            appid: "1"
          }
        ]
      },
      {
        node_id: "2898",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "2898",
        path: "0-2894",
        name: "员工管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "2898",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "2899",
            parent_id: "2898",
            application_id: "1",
            application_node_id: "2899",
            path: "0-2894-2898",
            name: "员工列表",
            url: "/Newsystem/Employee/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "2899",
            pid: "2898",
            appid: "1"
          }
        ]
      },
      {
        node_id: "2911",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "2911",
        path: "0-2894",
        name: "区域管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "2911",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "2912",
            parent_id: "2911",
            application_id: "1",
            application_node_id: "2912",
            path: "0-2894-2911",
            name: "区域字典表管理",
            url: "/Newsystem/District/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "2912",
            pid: "2911",
            appid: "1"
          }
        ]
      },
      {
        node_id: "2901",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "2901",
        path: "0-2894",
        name: "用户管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "2901",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "2905",
            parent_id: "2901",
            application_id: "1",
            application_node_id: "2905",
            path: "0-2894-2901",
            name: "用户列表",
            url: "/Newsystem/Users/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "1",
            menu: "1",
            id: "2905",
            pid: "2901",
            appid: "1"
          }
        ]
      },
      {
        node_id: "2902",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "2902",
        path: "0-2894",
        name: "数据权限因子管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "2902",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "2908",
            parent_id: "2902",
            application_id: "1",
            application_node_id: "2908",
            path: "0-2894-2902",
            name: "权限因子管理",
            url: "/Newsystem/DataConstrain/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "2908",
            pid: "2902",
            appid: "1"
          }
        ]
      },
      {
        node_id: "2903",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "2903",
        path: "0-2894",
        name: "功能模板管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "2903",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "2909",
            parent_id: "2903",
            application_id: "1",
            application_node_id: "2909",
            path: "0-2894-2903",
            name: "用户类型管理",
            url: "/Newsystem/Template/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "2909",
            pid: "2903",
            appid: "1"
          },
          {
            node_id: "2921",
            parent_id: "2903",
            application_id: "1",
            application_node_id: "2921",
            path: "0-2894-2903",
            name: "门店功能模板设置",
            url: "/NewSystem/StoreTemplate",
            is_del: "0",
            is_show_menu: "1",
            sort: "30",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "2921",
            pid: "2903",
            appid: "1"
          }
        ]
      },
      {
        node_id: "2917",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "2917",
        path: "0-2894",
        name: "功能角色管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "1",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "2917",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "2920",
            parent_id: "2917",
            application_id: "1",
            application_node_id: "2920",
            path: "0-2894-2917",
            name: "功能角色列表",
            url: "/NewSystem/RoleFunction/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "1",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "2920",
            pid: "2917",
            appid: "1"
          }
        ]
      },
      {
        node_id: "3258",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "3258",
        path: "0-2894",
        name: "外部用户管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "2",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "3258",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "3259",
            parent_id: "3258",
            application_id: "1",
            application_node_id: "3259",
            path: "0-2894-3258",
            name: "外部用户列表",
            url: "/newsystem/ExternalUsers/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "3259",
            pid: "3258",
            appid: "1"
          }
        ]
      },
      {
        node_id: "2915",
        parent_id: "2894",
        application_id: "1",
        application_node_id: "2915",
        path: "0-2894",
        name: "数据角色管理",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "2",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "2915",
        pid: "2894",
        appid: "1",
        _child: [
          {
            node_id: "2918",
            parent_id: "2915",
            application_id: "1",
            application_node_id: "2918",
            path: "0-2894-2915",
            name: "数据角色列表",
            url: "/NewSystem/RoleData/index",
            is_del: "0",
            is_show_menu: "1",
            sort: "1",
            icon: "",
            sub_folder: "",
            remark: "",
            danger: "2",
            menu: "1",
            id: "2918",
            pid: "2915",
            appid: "1"
          }
        ]
      }
    ]
  },
  {
    node_id: "2377",
    parent_id: "0",
    application_id: "1",
    application_node_id: "2377",
    path: "0",
    name: "券中心",
    url: "",
    is_del: "0",
    is_show_menu: "1",
    sort: "0",
    icon: "default.png",
    sub_folder: null,
    remark: null,
    danger: "2",
    menu: "1",
    id: "2377",
    pid: "0",
    appid: "1",
    _child: [
      {
        node_id: "2379",
        parent_id: "2377",
        application_id: "1",
        application_node_id: "2379",
        path: "0-2377",
        name: "优惠券列表",
        url: "http://admincoupon.sit.ffan.com/page/CouponsManagement",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: null,
        sub_folder: null,
        remark: null,
        danger: "2",
        menu: "1",
        id: "2379",
        pid: "2377",
        appid: "1"
      },
      {
        node_id: "2380",
        parent_id: "2377",
        application_id: "1",
        application_node_id: "2380",
        path: "0-2377",
        name: "券模板管理",
        url: "http://admincoupon.sit.ffan.com/page/TemplatesManagement",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: null,
        sub_folder: null,
        remark: null,
        danger: "2",
        menu: "1",
        id: "2380",
        pid: "2377",
        appid: "1"
      },
      {
        node_id: "2381",
        parent_id: "2377",
        application_id: "1",
        application_node_id: "2381",
        path: "0-2377",
        name: "券核销查询(旧)",
        url: "/coupon/couponverification",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: null,
        sub_folder: null,
        remark: null,
        danger: "2",
        menu: "1",
        id: "2381",
        pid: "2377",
        appid: "1"
      },
      {
        node_id: "2382",
        parent_id: "2377",
        application_id: "1",
        application_node_id: "2382",
        path: "0-2377",
        name: "券状态查询",
        url: "/order/coupon/index",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: null,
        sub_folder: null,
        remark: null,
        danger: "2",
        menu: "1",
        id: "2382",
        pid: "2377",
        appid: "1"
      },
      {
        node_id: "2384",
        parent_id: "2377",
        application_id: "1",
        application_node_id: "2384",
        path: "0-2377",
        name: "通用券管理",
        url: "/coupon/coupon/index",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: null,
        sub_folder: null,
        remark: null,
        danger: "2",
        menu: "1",
        id: "2384",
        pid: "2377",
        appid: "1"
      },
      {
        node_id: "2388",
        parent_id: "2377",
        application_id: "1",
        application_node_id: "2388",
        path: "0-2377",
        name: "外部业态适配",
        url: "",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: null,
        sub_folder: null,
        remark: null,
        danger: "2",
        menu: "1",
        id: "2388",
        pid: "2377",
        appid: "1",
        _child: [
          {
            node_id: "2386",
            parent_id: "2388",
            application_id: "1",
            application_node_id: "2386",
            path: "0-2377-2388",
            name: "业态管理",
            url: "http://admincoupon.sit.ffan.com/page/BusinessManagement",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: null,
            sub_folder: null,
            remark: null,
            danger: "2",
            menu: "1",
            id: "2386",
            pid: "2388",
            appid: "1"
          },
          {
            node_id: "2387",
            parent_id: "2388",
            application_id: "1",
            application_node_id: "2387",
            path: "0-2377-2388",
            name: "属性管理",
            url: "http://admincoupon.sit.ffan.com/page/AttributeManagement",
            is_del: "0",
            is_show_menu: "1",
            sort: "0",
            icon: null,
            sub_folder: null,
            remark: null,
            danger: "2",
            menu: "1",
            id: "2387",
            pid: "2388",
            appid: "1"
          }
        ]
      },
      {
        node_id: "3571",
        parent_id: "2377",
        application_id: "1",
        application_node_id: "3571",
        path: "0-2377",
        name: "新建优惠券",
        url: "https://admincoupon.sit.ffan.com/page/NewCoupons",
        is_del: "0",
        is_show_menu: "1",
        sort: "0",
        icon: "",
        sub_folder: "",
        remark: "",
        danger: "2",
        menu: "1",
        id: "3571",
        pid: "2377",
        appid: "1"
      }
    ]
  }
];

let config = {
  childrenAttr: '_child',
  idAttr: 'id',
  parentAttr: 'pid',
  hrefAttr: 'url',
  textAttr: 'name',
  iconAttr: 'icon'
};

let data = {
  id: '_auto_root_',
  [config.childrenAttr]: demoTree
};

let tree = new Tree(data, config);

describe('tree', () => {
  it('traverseDF', () => {
    let result = [];
    tree.traverse(node => {
      result.push(parseInt(node.id))
    });
    expect(result.length).to.be.equal(32);
    expect(result[1]).to.be.equal(182);
    expect(result[2]).to.be.equal(2894);
    expect(result[3]).to.be.equal(2895);
  });

  it('getNodeById', () => {
    let targerNode = tree.getNodeById('2895');
    expect(targerNode.name).to.be.equal('组织架构管理');
  });

  it('traverseUp', () => {
    let result = [];
    tree.traverseUp({
      node_id: "2896",
      parent_id: "2895",
      application_id: "1",
      application_node_id: "2896",
      path: "0-2894-2895",
      name: "组织架构列表",
      url: "/Newsystem/Organization/index",
      is_del: "0",
      is_show_menu: "1",
      sort: "0",
      icon: "",
      sub_folder: "",
      remark: "",
      danger: "2",
      menu: "1",
      id: "2896",
      pid: "2895",
      appid: "1"
    }, node => {
      if(!node) {
        return true;
      }
      result.push(parseInt(node.id))
    });
    expect(result.length).to.be.equal(2);
    expect(result[0]).to.be.equal(2895);
    expect(result[1]).to.be.equal(2894);
  });
});



